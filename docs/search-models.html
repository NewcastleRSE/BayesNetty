<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>BayesNetty: Bayesian Network Software for Genetic Analyses</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="bayesnettystyles.css" />
<link rel="shortcut icon" href="favicon.ico" />
</head>
<body>
<!-- Begin Wrapper -->
<div id="wrapper">
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<!-- Begin Header -->
<div id="header">
<table><tr>
<td>
<img width="150" src="bayesnetty-logo.png" alt="BayesNetty: Bayesian Network Software for Genetic Analyses"/>
</td>
<td>
<p style="margin-left: 1em;">BayesNetty: Bayesian Network Software for Genetic Analyses</p>
</td></tr>
</table>
</div>
<!-- End Header -->
<!-- Begin Menu Navigation -->
<ul id="menunav">
<li><a href="index.html">Home</a></li>
<li><a href="downloads.html">Download</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
<!-- End Menu Navigation -->

</td></tr>
<tr><td>
<table border="0" cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<!-- Begin Left Column -->
<div id="leftcolumn">
<!-- Begin Contents Navigation -->
<div id="navcontainer">
<ul>
<li><a href="introduction.html">1 Introduction</a>
</li>
<li><a href="installation.html">2 Installation</a>
</li>
<li><a href="using.html">3 Using BayesNetty</a>
<ul>
<li><a href="using.html#basic-options">3.1 Basic Options</a></li>
<li><a href="using.html#parameterfile">3.2 Parameter file</a></li>
<li><a href="using.html#simple-example">3.3 Simple Example</a></li>
<li><a href="using.html#command-line">3.4 Command-line Options</a></li>
</ul>
</li>
<li><a href="parallel.html">4 Parallel BayesNetty</a>
<ul>
<li><a href="parallel.html#compile-parallel-code">4.1 Compilation Scripts</a></li>
</ul>
</li>
<li><a href="input-data.html">5 Input data</a>
<ul>
<li><a href="input-data.html#input-data-options">5.1 Options</a></li>
<li><a href="input-data.html#input-data-discrete">5.2 Discrete data</a></li>
<li><a href="input-data.html#input-data-cts">5.3 Continuous data</a></li>
<li><a href="input-data.html#input-data-factor">5.4 Factor data</a></li>
<li><a href="input-data.html#input-data-snp">5.5 SNP data</a></li>
<li><a href="input-data.html#input-data-missing">5.6 Missing data</a></li>
<li><a href="input-data.html#input-data-ids">5.7 Data IDs</a></li>
<li><a href="input-data.html#input-data-example">5.8 Example</a></li>
</ul>
</li>
<li><a href="input-network.html">6 Input network</a>
<ul>
<li><a href="input-network.html#input-network-options">6.1 Options</a></li>
<li><a href="input-network.html#input-network-black">6.2 Black lists</a></li>
<li><a href="input-network.html#input-network-white">6.3 White lists</a></li>
<li><a href="input-network.html#input-network-soft-con">6.4 Soft Constraints</a></li>
<li><a href="input-network.html#input-network-formats">6.5 Network formats</a></li>
<li><a href="input-network.html#input-network-example">6.6 Example</a></li>
</ul>
</li>
<li><a href="bnlearn.html">7 bnlearn network</a>
<ul>
<li><a href="bnlearn.html#bnlearn-score">7.1 Network score</a></li>
</ul>
</li>
<li><a href="deal.html">8 deal network</a>
<ul>
<li><a href="deal.html#imaginary-sample-size">8.1 Imaginary sample size</a></li>
</ul>
</li>
<li><a href="calc-score.html">9 Calculate network score</a>
<ul>
<li><a href="calc-score.html#calc-score-options">9.1 Options</a></li>
<li><a href="calc-score.html#calc-score-example">9.2 Example</a></li>
</ul>
</li>
<li><a href="calc-posterior.html">10 Calculate posterior</a>
<ul>
<li><a href="calc-posterior.html#calc-posterior-options">10.1 Options</a></li>
<li><a href="calc-posterior.html#calc-post-example">10.2 Example</a></li>
</ul>
</li>
<li><a href="search-models.html">11 Search models</a>
<ul>
<li><a href="search-models.html#search-models-options">11.1 Options</a></li>
<li><a href="search-models.html#search-models-greedy">11.2 Greedy search</a></li>
<li><a href="search-models.html#search-models-example">11.3 Example</a></li>
</ul>
</li>
<li><a href="average-network.html">12 Average network</a>
<ul>
<li><a href="average-network.html#average-network-options">12.1 Options</a></li>
<li><a href="average-network.html#average-network-score">12.2 Score Method</a></li>
<li><a href="average-network.html#average-network-example">12.3 Example</a></li>
<li><a href="average-network.html#average-network-parallel">12.4 Parallel Example</a></li>
</ul>
</li>
<li><a href="impute-data.html">13 Impute Data</a>
<ul>
<li><a href="impute-data.html#impute-data-options">13.1 Options</a></li>
<li><a href="impute-data.html#impute-example">13.2 Example</a></li>
<li><a href="impute-data.html#impute-parallel-example">13.3 Parallel Example</a></li>
</ul>
</li>
<li><a href="estimate-impute.html">14 Estimate Imputation Benefit</a>
<ul>
<li><a href="estimate-impute.html#estimate-impute-options">14.1 Options</a></li>
<li><a href="estimate-impute.html#estimate-impute-example">14.2 Example</a></li>
</ul>
</li>
<li><a href="calc-recall-precision.html">15 Calculate Recall and Precision</a>
<ul>
<li><a href="calc-recall-precision.html#calc-recall-precision-options">15.1 Options</a></li>
<li><a href="calc-recall-precision.html#calc-recall-precision-example">15.2 Example</a></li>
</ul>
</li>
<li><a href="sim-data.html">16 Simulate network data</a>
<ul>
<li><a href="sim-data.html#sim-data-options">16.1 Options</a></li>
<li><a href="sim-data.html#sim-data-example1">16.2 Example 1: no data</a></li>
<li><a href="sim-data.html#sim-data-example2">16.3 Example 2: data and fitted network</a></li>
<li><a href="sim-data.html#sim-data-example3">16.4 Example 3: data and unknown network</a></li>
</ul>
</li>
<li><a href="markov-blanket.html">17 Markov blanket</a>
<ul>
<li><a href="markov-blanket.html#markov-blanket-options">17.1 Options</a></li>
<li><a href="markov-blanket.html#calc-blanket-example">17.2 Example</a></li>
</ul>
</li>
<li><a href="output-network.html">18 Output network</a>
<ul>
<li><a href="output-network.html#output-network-options">18.1 Options</a></li>
<li><a href="output-network.html#output-network-example">18.2 Example</a></li>
</ul>
</li>
<li><a href="output-priors.html">19 Output priors (deal only)</a>
<ul>
<li><a href="output-priors.html#output-priors-options">19.1 Options</a></li>
<li><a href="output-priors.html#output-priors-example">19.2 Example</a></li>
</ul>
</li>
<li><a href="output-posteriors.html">20 Output posteriors</a>
<ul>
<li><a href="output-posteriors.html#output-posteriors-options">20.1 Options</a></li>
<li><a href="output-posteriors.html#output-posts-example">20.2 Example</a></li>
</ul>
</li>
<li><a href="plot-network.html">21 Network plotting</a>
<ul>
<li><a href="plot-network.html#igraph">21.1 igraph</a></li>
<li><a href="plot-network.html#igraph-example">21.2 Example</a></li>
</ul>
</li>
<li><a href="references.html">References</a></li>
</ul>
</div>
<!-- End Contents Navigation -->
</div>
<!-- End Left Column -->
</td>
<td valign="top">
<!-- Begin Right Column -->
<div id="rightcolumn">
<h1>11 Search models</h1>
<p>
Network models can be searched for one that best describes the data as given by the network model assumptions, network constraints, the network score and the data itself. The search option uses a network to start the search and finishes with it updated to the found best fit network. (If a network is not set then a default network is used.) Any constraints to the search must be set when the network is setup, see <a href="input-network.html">section 6</a>. </p>
<h2><a name="search-models-options">11.1 Options</a></h2>
<p>
The options are as follows: </p>
<table id="tablestylel" class="center">
<tr><th>Option </th><th>Description </th><th>Default</th></tr>
<tr class="alt"><td valign="top">-search-models </td><td valign="top">do a task to search network models </td><td valign="top"></td></tr>
<tr><td valign="top">-search-models-name name </td><td valign="top">label the task with a name </td><td valign="top">Task-n</td></tr>
<tr class="alt"><td valign="top">-search-models-network-name network </td><td valign="top">the name of the network to start the search from </td><td valign="top">previous network (or the default model given by a node for each data variable and no edges if there is no previous network)</td></tr>
<tr><td valign="top">-search-models-file search.dat </td><td valign="top">record the network models and scores in the search path to file search.dat </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-search-models-random-restarts n </td><td valign="top">do another n searches starting from a random network </td><td valign="top">0</td></tr>
<tr><td valign="top">-search-models-jitter-restarts m </td><td valign="top">after the initial search and every random restart search do another m searches jittered from the recently found network </td><td valign="top">0</td></tr>
</table>
<h2><a name="search-models-greedy">11.2 Greedy search</a></h2>
<p>
The greedy search algorithm is the default algorithm for searching through network models, and is currently the only search algorithm. </p>
<h3><a name="search-models-greedy-restart">Number of random restarts for the greedy algorithm</a></h3>
<p>
The greedy algorithm can be ran a further number of times from a random starting network. The number of random restarts is set by using the option <tt>-search-models-random-restarts</tt>. </p>
<h3><a name="search-models-greedy-jitter">Number of jitter restarts for the greedy algorithm</a></h3>
<p>
Once the greedy algorithm has converged on a final best fit network, the algorithm can be restarted at a network given by slightly modifying the best fit network, also called <i>jittering</i>. This may be useful to avoid the algorithm sticking in a local maximum whilst still retaining more or less the same network. The number of times times the search should be jittered is set by using the option <tt>-search-models-jitter-restarts</tt>. </p>
<p>
Random restarts and jittered restarts can be used together, if there are n random restarts and m jittered restarts then there will be (n + 1) times m searches. </p>
<h2><a name="search-models-example">11.3 Example</a></h2>
<p>
As an example of searching through network models the parameter file <tt>paras-search.txt</tt>, which can be found in <a href="example.zip">example.zip</a>, searches through network models starting from the default model given by a node for each data variable and no edges. </p>
<pre>
#input continuous data
-input-data
-input-data-file example-cts.dat
-input-data-cts

#input discrete data
-input-data
-input-data-file example-discrete.dat
-input-data-discrete

#input SNP data as discrete data
-input-data
-input-data-file example.bed
-input-data-discrete-snp

#search network models
-search-models
</pre>
<p>
This can be executed as usual </p>
<pre>
./bayesnetty paras-search.txt
</pre>
<p>
and will output something as follows </p>
<pre>
BayesNetty: Bayesian Network software, v1.00
--------------------------------------------------
Copyright 2015-present Richard Howey, GNU General Public License, v3
Institute of Genetic Medicine, Newcastle University

Random seed: 1551700554
--------------------------------------------------
Task name: Task-1
Loading data
Continuous data file: example-cts.dat
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
Missing value: not set
--------------------------------------------------
--------------------------------------------------
Task name: Task-2
Loading data
Discrete data file: example-discrete.dat
Number of ID columns: 2
Including the 1 and only variable in analysis
Each variable has 1500 data entries
Missing value: NA
--------------------------------------------------
--------------------------------------------------
Task name: Task-3
Loading data
SNP binary data file: example.bed
SNP data treated as discrete data
Total number of SNPs: 2
Total number of subjects: 1500
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
--------------------------------------------------
--------------------------------------------------
Task name: Task-4
Searching network models
--------------------------------------------------
Loading defaultNetwork network
Network type: bnlearn
Network score type: BIC
Total number of nodes: 5 (Discrete: 3 | Factor: 0 | Continuous: 2)
Total number of edges: 0
Network Structure: [express][pheno][mood][rs1][rs2]
Total data at each node: 1495
Missing data at each node: 5
--------------------------------------------------
Network: defaultNetwork
Search: Greedy
Random restarts: 0
Random jitter restarts: 0
Network Structure: [mood][rs1][rs2][express|rs1:rs2][pheno|express:mood]
Network score type: BIC
Network score = -8213.45
--------------------------------------------------

Run time: less than one second
</pre>
<p>
The above shows the data input and then the default network input consisting of a node for each data variable given by the data and no edges. The network with the highest network score is shown in the output. </p>
<br />
<div class="prevnext"><span class="left"><a href="calc-posterior.html">&lt;-prev</a>
</span><span class="right"><a href="average-network.html">next-&gt;</a>
</span></div><!-- End Right Column -->
</div>
</td>
</tr></table>
<!-- End Wrapper -->
</td></tr></table>
</div>
 <!-- Default Statcounter code for Bayesnetty https://www.staff.ncl.ac.uk/richard.howey/bayesnetty/ --> <script type="text/javascript"> var sc_project=12004770; var sc_invisible=1; var sc_security="1ca06837"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12004770/0/1ca06837/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></body>
</html>
