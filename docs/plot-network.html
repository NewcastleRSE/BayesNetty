<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>BayesNetty: Bayesian Network Software for Genetic Analyses</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="bayesnettystyles.css" />
<link rel="shortcut icon" href="favicon.ico" />
</head>
<body>
<!-- Begin Wrapper -->
<div id="wrapper">
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<!-- Begin Header -->
<div id="header">
<table><tr>
<td>
<img width="150" src="bayesnetty-logo.png" alt="BayesNetty: Bayesian Network Software for Genetic Analyses"/>
</td>
<td>
<p style="margin-left: 1em;">BayesNetty: Bayesian Network Software for Genetic Analyses</p>
</td></tr>
</table>
</div>
<!-- End Header -->
<!-- Begin Menu Navigation -->
<ul id="menunav">
<li><a href="index.html">Home</a></li>
<li><a href="downloads.html">Download</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
<!-- End Menu Navigation -->

</td></tr>
<tr><td>
<table border="0" cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<!-- Begin Left Column -->
<div id="leftcolumn">
<!-- Begin Contents Navigation -->
<div id="navcontainer">
<ul>
<li><a href="introduction.html">1 Introduction</a>
</li>
<li><a href="installation.html">2 Installation</a>
</li>
<li><a href="using.html">3 Using BayesNetty</a>
<ul>
<li><a href="using.html#basic-options">3.1 Basic Options</a></li>
<li><a href="using.html#parameterfile">3.2 Parameter file</a></li>
<li><a href="using.html#simple-example">3.3 Simple Example</a></li>
<li><a href="using.html#command-line">3.4 Command-line Options</a></li>
</ul>
</li>
<li><a href="parallel.html">4 Parallel BayesNetty</a>
<ul>
<li><a href="parallel.html#compile-parallel-code">4.1 Compilation Scripts</a></li>
</ul>
</li>
<li><a href="input-data.html">5 Input data</a>
<ul>
<li><a href="input-data.html#input-data-options">5.1 Options</a></li>
<li><a href="input-data.html#input-data-discrete">5.2 Discrete data</a></li>
<li><a href="input-data.html#input-data-cts">5.3 Continuous data</a></li>
<li><a href="input-data.html#input-data-factor">5.4 Factor data</a></li>
<li><a href="input-data.html#input-data-snp">5.5 SNP data</a></li>
<li><a href="input-data.html#input-data-missing">5.6 Missing data</a></li>
<li><a href="input-data.html#input-data-ids">5.7 Data IDs</a></li>
<li><a href="input-data.html#input-data-example">5.8 Example</a></li>
</ul>
</li>
<li><a href="input-network.html">6 Input network</a>
<ul>
<li><a href="input-network.html#input-network-options">6.1 Options</a></li>
<li><a href="input-network.html#input-network-black">6.2 Black lists</a></li>
<li><a href="input-network.html#input-network-white">6.3 White lists</a></li>
<li><a href="input-network.html#input-network-soft-con">6.4 Soft Constraints</a></li>
<li><a href="input-network.html#input-network-formats">6.5 Network formats</a></li>
<li><a href="input-network.html#input-network-example">6.6 Example</a></li>
</ul>
</li>
<li><a href="bnlearn.html">7 bnlearn network</a>
<ul>
<li><a href="bnlearn.html#bnlearn-score">7.1 Network score</a></li>
</ul>
</li>
<li><a href="deal.html">8 deal network</a>
<ul>
<li><a href="deal.html#imaginary-sample-size">8.1 Imaginary sample size</a></li>
</ul>
</li>
<li><a href="calc-score.html">9 Calculate network score</a>
<ul>
<li><a href="calc-score.html#calc-score-options">9.1 Options</a></li>
<li><a href="calc-score.html#calc-score-example">9.2 Example</a></li>
</ul>
</li>
<li><a href="calc-posterior.html">10 Calculate posterior</a>
<ul>
<li><a href="calc-posterior.html#calc-posterior-options">10.1 Options</a></li>
<li><a href="calc-posterior.html#calc-post-example">10.2 Example</a></li>
</ul>
</li>
<li><a href="search-models.html">11 Search models</a>
<ul>
<li><a href="search-models.html#search-models-options">11.1 Options</a></li>
<li><a href="search-models.html#search-models-greedy">11.2 Greedy search</a></li>
<li><a href="search-models.html#search-models-example">11.3 Example</a></li>
</ul>
</li>
<li><a href="average-network.html">12 Average network</a>
<ul>
<li><a href="average-network.html#average-network-options">12.1 Options</a></li>
<li><a href="average-network.html#average-network-score">12.2 Score Method</a></li>
<li><a href="average-network.html#average-network-example">12.3 Example</a></li>
<li><a href="average-network.html#average-network-parallel">12.4 Parallel Example</a></li>
</ul>
</li>
<li><a href="impute-data.html">13 Impute Data</a>
<ul>
<li><a href="impute-data.html#impute-data-options">13.1 Options</a></li>
<li><a href="impute-data.html#impute-example">13.2 Example</a></li>
<li><a href="impute-data.html#impute-parallel-example">13.3 Parallel Example</a></li>
</ul>
</li>
<li><a href="sim-data.html">14 Simulate network data</a>
<ul>
<li><a href="sim-data.html#sim-data-options">14.1 Options</a></li>
<li><a href="sim-data.html#sim-data-example1">14.2 Example 1: no data</a></li>
<li><a href="sim-data.html#sim-data-example2">14.3 Example 2: data and fitted network</a></li>
<li><a href="sim-data.html#sim-data-example3">14.4 Example 3: data and unknown network</a></li>
</ul>
</li>
<li><a href="markov-blanket.html">15 Markov blanket</a>
<ul>
<li><a href="markov-blanket.html#markov-blanket-options">15.1 Options</a></li>
<li><a href="markov-blanket.html#calc-blanket-example">15.2 Example</a></li>
</ul>
</li>
<li><a href="output-network.html">16 Output network</a>
<ul>
<li><a href="output-network.html#output-network-options">16.1 Options</a></li>
<li><a href="output-network.html#output-network-example">16.2 Example</a></li>
</ul>
</li>
<li><a href="output-priors.html">17 Output priors (deal only)</a>
<ul>
<li><a href="output-priors.html#output-priors-options">17.1 Options</a></li>
<li><a href="output-priors.html#output-priors-example">17.2 Example</a></li>
</ul>
</li>
<li><a href="output-posteriors.html">18 Output posteriors</a>
<ul>
<li><a href="output-posteriors.html#output-posteriors-options">18.1 Options</a></li>
<li><a href="output-posteriors.html#output-posts-example">18.2 Example</a></li>
</ul>
</li>
<li><a href="plot-network.html">19 Network plotting</a>
<ul>
<li><a href="plot-network.html#igraph">19.1 igraph</a></li>
<li><a href="plot-network.html#igraph-example">19.2 Example</a></li>
</ul>
</li>
<li><a href="references.html">References</a></li>
</ul>
</div>
<!-- End Contents Navigation -->
</div>
<!-- End Left Column -->
</td>
<td valign="top">
<!-- Begin Right Column -->
<div id="rightcolumn">
<h1>19 Network plotting</h1>
<h2><a name="igraph">19.1 igraph</a></h2>
<p>
A network may be plotted using the <a href="http://igraph.org">igraph</a>&nbsp;R package, see <a href="references.html#igraph">Csardi and Nepusz (2006)</a> for details. The option is part of the network output options, see <a href="output-network.html">section 16</a>. </p>
<h2><a name="igraph-example">19.2 Example</a></h2>
<p>
The following is an example parameter file to output the necessary files to plot the network in R with the igraph package. BayesNetty uses the input data and the input network to calculate for each edge a chi squared value, representing twice the difference in log likelihoods between the network where the edge is present and the network where it is absent. </p>
<pre>
#input continuous data
-input-data
-input-data-file example-cts.dat
-input-data-cts

#input discrete data
-input-data
-input-data-file example-discrete.dat
-input-data-discrete

#input SNP data as discrete data
-input-data
-input-data-file example.bed
-input-data-discrete-snp

#input the example network in format 1
-input-network
-input-network-file example-network-format1.dat

#output files to plot the network
-output-network
-output-network-igraph-file-prefix exampleGraph
</pre>
<p>
This parameter file, <tt>paras-plot-network.txt</tt>, can be found in <a href="example.zip">example.zip</a>&nbsp;and can be used as follows: </p>
<pre>
./bayesnetty paras-plot-network.txt
</pre>
<p>
Which should produce output that looks like something as follows: </p>
<pre>
BayesNetty: Bayesian Network software, v1.00
--------------------------------------------------
Copyright 2015-present Richard Howey, GNU General Public License, v3
Institute of Genetic Medicine, Newcastle University

Random seed: 1551716944
--------------------------------------------------
Task name: Task-1
Loading data
Continuous data file: example-cts.dat
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
Missing value: not set
--------------------------------------------------
--------------------------------------------------
Task name: Task-2
Loading data
Discrete data file: example-discrete.dat
Number of ID columns: 2
Including the 1 and only variable in analysis
Each variable has 1500 data entries
Missing value: NA
--------------------------------------------------
--------------------------------------------------
Task name: Task-3
Loading data
SNP binary data file: example.bed
SNP data treated as discrete data
Total number of SNPs: 2
Total number of subjects: 1500
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
--------------------------------------------------
--------------------------------------------------
Task name: Task-4
Loading network
Network file: example-network-format1.dat
Network type: bnlearn
Network score type: BIC
Total number of nodes: 5 (Discrete: 3 | Factor: 0 | Continuous: 2)
Total number of edges: 4
Network Structure: [mood][rs1][rs2][pheno|rs1:rs2][express|pheno:mood]
Total data at each node: 1495
Missing data at each node: 5
--------------------------------------------------
--------------------------------------------------
Task name: Task-5
Outputting network
Network: Task-4
Network Structure: [mood][rs1][rs2][pheno|rs1:rs2][express|pheno:mood]
Network output to igraph files:
 exampleGraph-nodes.dat
 exampleGraph-edges.dat
R code to plot network using igraph package: exampleGraph-plot.R
--------------------------------------------------

Run time: less than one second
</pre>
<p>
The data is loaded, the network input and output to 2 separate files, one containing the node data and another containing the edge data. </p>
<p>
There is also an R file which is output which will look something as follows: </p>
<pre>
#load igraph library, http://igraph.org/r/
library(igraph)

#load network graph
nodes&lt;-read.table("exampleGraph-nodes.dat", header=TRUE)
edges&lt;-read.table("exampleGraph-edges.dat", header=TRUE)

#create graph
graph&lt;-graph_from_data_frame(edges, directed = TRUE, vertices = nodes)

#plot the network and output png file, edit style as required

#style for continuous nodes
shape&lt;-rep("circle", length(nodes$type))
vcolor&lt;-rep("#eeeeee", length(nodes$type))
vsize&lt;-rep(25, length(nodes$type))
color&lt;-rep("black", length(nodes$type))

#style for discrete nodes
shape[nodes$type=="d"]&lt;-"rectangle"
vcolor[nodes$type=="d"]&lt;-"#111111"
vsize[nodes$type=="d"]&lt;-20
color[nodes$type=="d"]&lt;-"white"

#style for factor nodes
shape[nodes$type=="f"]&lt;-"rectangle"
vcolor[nodes$type=="f"]&lt;-"#eeeeee"
vsize[nodes$type=="f"]&lt;-20
color[nodes$type=="f"]&lt;-"black"

#edge widths for significances
minWidth&lt;-0.3
maxWidth&lt;-10
edgeMax&lt;-max(edges$chisq)
edgeMin&lt;-min(edges$chisq)
widths&lt;-((edges$chisq-edgeMin)/(edgeMax-edgeMin))*(maxWidth - minWidth) + minWidth
styles&lt;-rep(1, length(widths))

#plot to a png file
png(filename="exampleGraph.png", width=800, height=800)

plot(graph, vertex.shape=shape, vertex.size=vsize, vertex.color=vcolor, vertex.label.color=color, edge.width=widths, edge.lty=styles, edge.color="black", edge.arrow.size=1.5)

#finish png file
dev.off()
</pre>
<p>
This R file can be ran as follows in Linux </p>
<pre>
R --vanilla &lt; exampleGraph-plot.R
</pre>
<p>
and produces the .png image file of the network </p>
<div id="fig"><a href="exampleGraph.png"><img src="exampleGraph.png" border="0" class="figimg" width="700"></a><br />
<br />
Figure 3. Plot of the example network drawn using the igraph R package.
</div>
<p>
The edges are drawn proportional to the log likelihood difference between networks with and without the edge in question. The minimum and maximum thickness of the plotted edges can be changed by modifying the <tt>minWidth</tt> and <tt>maxWidth</tt> variables in the R file. The plot can easily be updated to your needs by following the <a href="http://igraph.org">igraph</a>&nbsp;R package documentation. </p>
<p>
If a search is performed to find the best network (see parameter file <tt>paras-plot-network2.txt</tt>), it can be plotted as above and gives the following network: </p>
<div id="fig"><a href="exampleGraph2.png"><img src="exampleGraph2.png" border="0" class="figimg" width="700"></a><br />
<br />
Figure 4. Plot of the best fit network drawn using the igraph R package.
</div>
<br />
<div class="prevnext"><span class="left"><a href="output-posteriors.html">&lt;-prev</a>
</span></div><!-- End Right Column -->
</div>
</td>
</tr></table>
<!-- End Wrapper -->
</td></tr></table>
</div>
 <!-- Default Statcounter code for Bayesnetty https://www.staff.ncl.ac.uk/richard.howey/bayesnetty/ --> <script type="text/javascript"> var sc_project=12004770; var sc_invisible=1; var sc_security="1ca06837"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12004770/0/1ca06837/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></body>
</html>
