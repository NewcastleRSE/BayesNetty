<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>BayesNetty: Bayesian Network Software for Genetic Analyses</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="bayesnettystyles.css" />
<link rel="shortcut icon" href="favicon.ico" />
</head>
<body>
<!-- Begin Wrapper -->
<div id="wrapper">
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<!-- Begin Header -->
<div id="header">
<table><tr>
<td>
<img width="150" src="bayesnetty-logo.png" alt="BayesNetty: Bayesian Network Software for Genetic Analyses"/>
</td>
<td>
<p style="margin-left: 1em;">BayesNetty: Bayesian Network Software for Genetic Analyses</p>
</td></tr>
</table>
</div>
<!-- End Header -->
<!-- Begin Menu Navigation -->
<ul id="menunav">
<li><a href="index.html">Home</a></li>
<li><a href="downloads.html">Download</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
<!-- End Menu Navigation -->

</td></tr>
<tr><td>
<table border="0" cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<!-- Begin Left Column -->
<div id="leftcolumn">
<!-- Begin Contents Navigation -->
<div id="navcontainer">
<ul>
<li><a href="introduction.html">1 Introduction</a>
</li>
<li><a href="installation.html">2 Installation</a>
</li>
<li><a href="using.html">3 Using BayesNetty</a>
<ul>
<li><a href="using.html#basic-options">3.1 Basic Options</a></li>
<li><a href="using.html#parameterfile">3.2 Parameter file</a></li>
<li><a href="using.html#simple-example">3.3 Simple Example</a></li>
<li><a href="using.html#command-line">3.4 Command-line Options</a></li>
</ul>
</li>
<li><a href="parallel.html">4 Parallel BayesNetty</a>
<ul>
<li><a href="parallel.html#compile-parallel-code">4.1 Compilation Scripts</a></li>
</ul>
</li>
<li><a href="input-data.html">5 Input data</a>
<ul>
<li><a href="input-data.html#input-data-options">5.1 Options</a></li>
<li><a href="input-data.html#input-data-discrete">5.2 Discrete data</a></li>
<li><a href="input-data.html#input-data-cts">5.3 Continuous data</a></li>
<li><a href="input-data.html#input-data-factor">5.4 Factor data</a></li>
<li><a href="input-data.html#input-data-snp">5.5 SNP data</a></li>
<li><a href="input-data.html#input-data-missing">5.6 Missing data</a></li>
<li><a href="input-data.html#input-data-ids">5.7 Data IDs</a></li>
<li><a href="input-data.html#input-data-example">5.8 Example</a></li>
</ul>
</li>
<li><a href="input-network.html">6 Input network</a>
<ul>
<li><a href="input-network.html#input-network-options">6.1 Options</a></li>
<li><a href="input-network.html#input-network-black">6.2 Black lists</a></li>
<li><a href="input-network.html#input-network-white">6.3 White lists</a></li>
<li><a href="input-network.html#input-network-soft-con">6.4 Soft Constraints</a></li>
<li><a href="input-network.html#input-network-formats">6.5 Network formats</a></li>
<li><a href="input-network.html#input-network-example">6.6 Example</a></li>
</ul>
</li>
<li><a href="bnlearn.html">7 bnlearn network</a>
<ul>
<li><a href="bnlearn.html#bnlearn-score">7.1 Network score</a></li>
</ul>
</li>
<li><a href="deal.html">8 deal network</a>
<ul>
<li><a href="deal.html#imaginary-sample-size">8.1 Imaginary sample size</a></li>
</ul>
</li>
<li><a href="calc-score.html">9 Calculate network score</a>
<ul>
<li><a href="calc-score.html#calc-score-options">9.1 Options</a></li>
<li><a href="calc-score.html#calc-score-example">9.2 Example</a></li>
</ul>
</li>
<li><a href="calc-posterior.html">10 Calculate posterior</a>
<ul>
<li><a href="calc-posterior.html#calc-posterior-options">10.1 Options</a></li>
<li><a href="calc-posterior.html#calc-post-example">10.2 Example</a></li>
</ul>
</li>
<li><a href="search-models.html">11 Search models</a>
<ul>
<li><a href="search-models.html#search-models-options">11.1 Options</a></li>
<li><a href="search-models.html#search-models-greedy">11.2 Greedy search</a></li>
<li><a href="search-models.html#search-models-example">11.3 Example</a></li>
</ul>
</li>
<li><a href="average-network.html">12 Average network</a>
<ul>
<li><a href="average-network.html#average-network-options">12.1 Options</a></li>
<li><a href="average-network.html#average-network-score">12.2 Score Method</a></li>
<li><a href="average-network.html#average-network-example">12.3 Example</a></li>
<li><a href="average-network.html#average-network-parallel">12.4 Parallel Example</a></li>
</ul>
</li>
<li><a href="impute-data.html">13 Impute Data</a>
<ul>
<li><a href="impute-data.html#impute-data-options">13.1 Options</a></li>
<li><a href="impute-data.html#impute-example">13.2 Example</a></li>
<li><a href="impute-data.html#impute-parallel-example">13.3 Parallel Example</a></li>
</ul>
</li>
<li><a href="estimate-impute.html">14 Estimate Imputation Benefit</a>
<ul>
<li><a href="estimate-impute.html#estimate-impute-options">14.1 Options</a></li>
<li><a href="estimate-impute.html#estimate-impute-example">14.2 Example</a></li>
</ul>
</li>
<li><a href="calc-recall-precision.html">15 Calculate Recall and Precision</a>
<ul>
<li><a href="calc-recall-precision.html#calc-recall-precision-options">15.1 Options</a></li>
<li><a href="calc-recall-precision.html#calc-recall-precision-example">15.2 Example</a></li>
</ul>
</li>
<li><a href="sim-data.html">16 Simulate network data</a>
<ul>
<li><a href="sim-data.html#sim-data-options">16.1 Options</a></li>
<li><a href="sim-data.html#sim-data-example1">16.2 Example 1: no data</a></li>
<li><a href="sim-data.html#sim-data-example2">16.3 Example 2: data and fitted network</a></li>
<li><a href="sim-data.html#sim-data-example3">16.4 Example 3: data and unknown network</a></li>
</ul>
</li>
<li><a href="markov-blanket.html">17 Markov blanket</a>
<ul>
<li><a href="markov-blanket.html#markov-blanket-options">17.1 Options</a></li>
<li><a href="markov-blanket.html#calc-blanket-example">17.2 Example</a></li>
</ul>
</li>
<li><a href="output-network.html">18 Output network</a>
<ul>
<li><a href="output-network.html#output-network-options">18.1 Options</a></li>
<li><a href="output-network.html#output-network-example">18.2 Example</a></li>
</ul>
</li>
<li><a href="output-priors.html">19 Output priors (deal only)</a>
<ul>
<li><a href="output-priors.html#output-priors-options">19.1 Options</a></li>
<li><a href="output-priors.html#output-priors-example">19.2 Example</a></li>
</ul>
</li>
<li><a href="output-posteriors.html">20 Output posteriors</a>
<ul>
<li><a href="output-posteriors.html#output-posteriors-options">20.1 Options</a></li>
<li><a href="output-posteriors.html#output-posts-example">20.2 Example</a></li>
</ul>
</li>
<li><a href="plot-network.html">21 Network plotting</a>
<ul>
<li><a href="plot-network.html#igraph">21.1 igraph</a></li>
<li><a href="plot-network.html#igraph-example">21.2 Example</a></li>
</ul>
</li>
<li><a href="references.html">References</a></li>
</ul>
</div>
<!-- End Contents Navigation -->
</div>
<!-- End Left Column -->
</td>
<td valign="top">
<!-- Begin Right Column -->
<div id="rightcolumn">
<h1>10 Calculate posterior</h1>
<p>
The likelihood is calculated under specific distributional assumptions, namely that discrete nodes follow a multinomial distribution and continuous nodes a normal distribution, with distributional parameters determined by the values of the incoming parent nodes. We call the network structure with its corresponding distributional parameters the posterior. </p>
<p>
If only the posterior is of interest then the <tt>-calc-posterior</tt> option can be used without the need to perform any other analyses. One would probably want to also use the <tt>-output-posteriors</tt> option to output the posteriors, see <a href="output-posteriors.html">section 20</a>. </p>
<h2><a name="calc-posterior-options">10.1 Options</a></h2>
<p>
The options are as follows: </p>
<table id="tablestylel" class="center">
<tr><th>Option </th><th>Description </th><th>Default</th></tr>
<tr class="alt"><td valign="top">-calc-posterior </td><td valign="top">do a task to calculate the posterior </td><td valign="top"></td></tr>
<tr><td valign="top">-calc-posterior-name name </td><td valign="top">label the task with a name </td><td valign="top">Task-n</td></tr>
<tr class="alt"><td valign="top">-calc-posterior-network-name network </td><td valign="top">the name of the network to calculate the posterior of </td><td valign="top">previous network (or the default model given by a node for each data variable and no edges if there is no previous network)</td></tr>
</table>
<h2><a name="calc-post-example">10.2 Example</a></h2>
<p>
The posterior is calculated by simply using the <tt>-calc-posterior</tt> option in the parameter file after the data and network has been set up. For example: </p>
<pre>
#input continuous data
-input-data
-input-data-file example-cts.dat
-input-data-cts

#input discrete data
-input-data
-input-data-file example-discrete.dat
-input-data-discrete

#input SNP data as discrete data
-input-data
-input-data-file example.bed
-input-data-discrete-snp

#input the example network in format 1
-input-network
-input-network-file example-network-format1.dat

#calculate the posterior of the network
-calc-posterior
</pre>
<p>
Note that the network has not been set for the <tt>-calc-posterior</tt> task as there is only one network, and so by default the most recent network is used. This parameter file, <tt>paras-calc-post.txt</tt>, can be found in <a href="example.zip">example.zip</a>&nbsp;and produces the following output: </p>
<pre>
BayesNetty: Bayesian Network software, v1.00
--------------------------------------------------
Copyright 2015-present Richard Howey, GNU General Public License, v3
Institute of Genetic Medicine, Newcastle University

Random seed: 1551697290
--------------------------------------------------
Task name: Task-1
Loading data
Continuous data file: example-cts.dat
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
Missing value: not set
--------------------------------------------------
--------------------------------------------------
Task name: Task-2
Loading data
Discrete data file: example-discrete.dat
Number of ID columns: 2
Including the 1 and only variable in analysis
Each variable has 1500 data entries
Missing value: NA
--------------------------------------------------
--------------------------------------------------
Task name: Task-3
Loading data
SNP binary data file: example.bed
SNP data treated as discrete data
Total number of SNPs: 2
Total number of subjects: 1500
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
--------------------------------------------------
--------------------------------------------------
Task name: Task-4
Loading network
Network file: example-network-format1.dat
Network type: bnlearn
Network score type: BIC
Total number of nodes: 5 (Discrete: 3 | Factor: 0 | Continuous: 2)
Total number of edges: 4
Network Structure: [mood][rs1][rs2][pheno|rs1:rs2][express|pheno:mood]
Total data at each node: 1495
Missing data at each node: 5
--------------------------------------------------
--------------------------------------------------
Task name: Task-5
Calculating posterior
Network: Task-4
Network Structure: [mood][rs1][rs2][pheno|rs1:rs2][express|pheno:mood]
--------------------------------------------------

Run time: less than one second
</pre>
<p>
For an example of calculating and outputting the posterior to file, see <a href="output-posteriors.html#output-posts-example">section 20.2</a>. </p>
<br />
<div class="prevnext"><span class="left"><a href="calc-score.html">&lt;-prev</a>
</span><span class="right"><a href="search-models.html">next-&gt;</a>
</span></div><!-- End Right Column -->
</div>
</td>
</tr></table>
<!-- End Wrapper -->
</td></tr></table>
</div>
 <!-- Default Statcounter code for Bayesnetty https://www.staff.ncl.ac.uk/richard.howey/bayesnetty/ --> <script type="text/javascript"> var sc_project=12004770; var sc_invisible=1; var sc_security="1ca06837"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12004770/0/1ca06837/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></body>
</html>
