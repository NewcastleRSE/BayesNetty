<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>BayesNetty: Bayesian Network Software for Genetic Analyses</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="bayesnettystyles.css" />
<link rel="shortcut icon" href="favicon.ico" />
</head>
<body>
<!-- Begin Wrapper -->
<div id="wrapper">
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<!-- Begin Header -->
<div id="header">
<table><tr>
<td>
<img width="150" src="bayesnetty-logo.png" alt="BayesNetty: Bayesian Network Software for Genetic Analyses"/>
</td>
<td>
<p style="margin-left: 1em;">BayesNetty: Bayesian Network Software for Genetic Analyses</p>
</td></tr>
</table>
</div>
<!-- End Header -->
<!-- Begin Menu Navigation -->
<ul id="menunav">
<li><a href="index.html">Home</a></li>
<li><a href="downloads.html">Download</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
<!-- End Menu Navigation -->

</td></tr>
<tr><td>
<table border="0" cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<!-- Begin Left Column -->
<div id="leftcolumn">
<!-- Begin Contents Navigation -->
<div id="navcontainer">
<ul>
<li><a href="introduction.html">1 Introduction</a>
</li>
<li><a href="installation.html">2 Installation</a>
</li>
<li><a href="using.html">3 Using BayesNetty</a>
<ul>
<li><a href="using.html#basic-options">3.1 Basic Options</a></li>
<li><a href="using.html#parameterfile">3.2 Parameter file</a></li>
<li><a href="using.html#simple-example">3.3 Simple Example</a></li>
<li><a href="using.html#command-line">3.4 Command-line Options</a></li>
</ul>
</li>
<li><a href="parallel.html">4 Parallel BayesNetty</a>
<ul>
<li><a href="parallel.html#compile-parallel-code">4.1 Compilation Scripts</a></li>
</ul>
</li>
<li><a href="input-data.html">5 Input data</a>
<ul>
<li><a href="input-data.html#input-data-options">5.1 Options</a></li>
<li><a href="input-data.html#input-data-discrete">5.2 Discrete data</a></li>
<li><a href="input-data.html#input-data-cts">5.3 Continuous data</a></li>
<li><a href="input-data.html#input-data-factor">5.4 Factor data</a></li>
<li><a href="input-data.html#input-data-snp">5.5 SNP data</a></li>
<li><a href="input-data.html#input-data-missing">5.6 Missing data</a></li>
<li><a href="input-data.html#input-data-ids">5.7 Data IDs</a></li>
<li><a href="input-data.html#input-data-example">5.8 Example</a></li>
</ul>
</li>
<li><a href="input-network.html">6 Input network</a>
<ul>
<li><a href="input-network.html#input-network-options">6.1 Options</a></li>
<li><a href="input-network.html#input-network-black">6.2 Black lists</a></li>
<li><a href="input-network.html#input-network-white">6.3 White lists</a></li>
<li><a href="input-network.html#input-network-soft-con">6.4 Soft Constraints</a></li>
<li><a href="input-network.html#input-network-formats">6.5 Network formats</a></li>
<li><a href="input-network.html#input-network-example">6.6 Example</a></li>
</ul>
</li>
<li><a href="bnlearn.html">7 bnlearn network</a>
<ul>
<li><a href="bnlearn.html#bnlearn-score">7.1 Network score</a></li>
</ul>
</li>
<li><a href="deal.html">8 deal network</a>
<ul>
<li><a href="deal.html#imaginary-sample-size">8.1 Imaginary sample size</a></li>
</ul>
</li>
<li><a href="calc-score.html">9 Calculate network score</a>
<ul>
<li><a href="calc-score.html#calc-score-options">9.1 Options</a></li>
<li><a href="calc-score.html#calc-score-example">9.2 Example</a></li>
</ul>
</li>
<li><a href="calc-posterior.html">10 Calculate posterior</a>
<ul>
<li><a href="calc-posterior.html#calc-posterior-options">10.1 Options</a></li>
<li><a href="calc-posterior.html#calc-post-example">10.2 Example</a></li>
</ul>
</li>
<li><a href="search-models.html">11 Search models</a>
<ul>
<li><a href="search-models.html#search-models-options">11.1 Options</a></li>
<li><a href="search-models.html#search-models-greedy">11.2 Greedy search</a></li>
<li><a href="search-models.html#search-models-example">11.3 Example</a></li>
</ul>
</li>
<li><a href="average-network.html">12 Average network</a>
<ul>
<li><a href="average-network.html#average-network-options">12.1 Options</a></li>
<li><a href="average-network.html#average-network-score">12.2 Score Method</a></li>
<li><a href="average-network.html#average-network-example">12.3 Example</a></li>
<li><a href="average-network.html#average-network-parallel">12.4 Parallel Example</a></li>
</ul>
</li>
<li><a href="impute-data.html">13 Impute Data</a>
<ul>
<li><a href="impute-data.html#impute-data-options">13.1 Options</a></li>
<li><a href="impute-data.html#impute-example">13.2 Example</a></li>
<li><a href="impute-data.html#impute-parallel-example">13.3 Parallel Example</a></li>
</ul>
</li>
<li><a href="estimate-impute.html">14 Estimate Imputation Benefit</a>
<ul>
<li><a href="estimate-impute.html#estimate-impute-options">14.1 Options</a></li>
<li><a href="estimate-impute.html#estimate-impute-example">14.2 Example</a></li>
</ul>
</li>
<li><a href="calc-recall-precision.html">15 Calculate Recall and Precision</a>
<ul>
<li><a href="calc-recall-precision.html#calc-recall-precision-options">15.1 Options</a></li>
<li><a href="calc-recall-precision.html#calc-recall-precision-example">15.2 Example</a></li>
</ul>
</li>
<li><a href="sim-data.html">16 Simulate network data</a>
<ul>
<li><a href="sim-data.html#sim-data-options">16.1 Options</a></li>
<li><a href="sim-data.html#sim-data-example1">16.2 Example 1: no data</a></li>
<li><a href="sim-data.html#sim-data-example2">16.3 Example 2: data and fitted network</a></li>
<li><a href="sim-data.html#sim-data-example3">16.4 Example 3: data and unknown network</a></li>
</ul>
</li>
<li><a href="markov-blanket.html">17 Markov blanket</a>
<ul>
<li><a href="markov-blanket.html#markov-blanket-options">17.1 Options</a></li>
<li><a href="markov-blanket.html#calc-blanket-example">17.2 Example</a></li>
</ul>
</li>
<li><a href="output-network.html">18 Output network</a>
<ul>
<li><a href="output-network.html#output-network-options">18.1 Options</a></li>
<li><a href="output-network.html#output-network-example">18.2 Example</a></li>
</ul>
</li>
<li><a href="output-priors.html">19 Output priors (deal only)</a>
<ul>
<li><a href="output-priors.html#output-priors-options">19.1 Options</a></li>
<li><a href="output-priors.html#output-priors-example">19.2 Example</a></li>
</ul>
</li>
<li><a href="output-posteriors.html">20 Output posteriors</a>
<ul>
<li><a href="output-posteriors.html#output-posteriors-options">20.1 Options</a></li>
<li><a href="output-posteriors.html#output-posts-example">20.2 Example</a></li>
</ul>
</li>
<li><a href="plot-network.html">21 Network plotting</a>
<ul>
<li><a href="plot-network.html#igraph">21.1 igraph</a></li>
<li><a href="plot-network.html#igraph-example">21.2 Example</a></li>
</ul>
</li>
<li><a href="references.html">References</a></li>
</ul>
</div>
<!-- End Contents Navigation -->
</div>
<!-- End Left Column -->
</td>
<td valign="top">
<!-- Begin Right Column -->
<div id="rightcolumn">
<h1>6 Input network</h1>
<p>
A network may be specified using the <tt>-input-network</tt> task. The network may be used as a starting point for analyses, such as searches, or to perform an analysis on this network. Only nodes in input files will be used in the network so that a subset of the data may be specified. </p>
<p>
Any network <b>constraints</b> must be set using the <tt>-input-network</tt> option. These constraints then belong to the network and will be used in any subsquent analysis, including searches, calculating average networks etc. </p>
<p>
If no network is specified then a network with no edges and a node for every data variable (as given by the input data) will be created and named &ldquo;defaultNetwork&rdquo;. </p>
<h2><a name="input-network-options">6.1 Options</a></h2>
<p>
The options are as follows: </p>
<table id="tablestylel" class="center">
<tr><th>Option </th><th>Description </th><th>Default</th></tr>
<tr class="alt"><td valign="top">-input-network </td><td valign="top">do a task to input a network </td><td valign="top"></td></tr>
<tr><td valign="top">-input-network-name name </td><td valign="top">label the task and network with a name </td><td valign="top">Task-n</td></tr>
<tr class="alt"><td valign="top">-input-network-type t </td><td valign="top">the type of Bayesian network, choose between bnlearn or deal </td><td valign="top">bnlearn</td></tr>
<tr><td valign="top">-input-network-file network.dat </td><td valign="top">input the network in a format where the nodes and then the edges are listed </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-input-network-file2 network2.dat </td><td valign="top">input the network in this style of format: <tt>[a][b|a][c|a:b]</tt> </td><td valign="top"></td></tr>
<tr><td valign="top">-input-network-igraph-file-prefix mygraph </td><td valign="top">input the network from igraph format files consisting of mygraph-nodes.dat and mygraph-edges.dat </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-input-network-empty </td><td valign="top">set the network to one with no edges and one node for every data variable. An input network file is not required if this option is used </td><td valign="top"></td></tr>
<tr><td valign="top">-input-network-whitelist-file whitelist.dat </td><td valign="top">a list of edges that must be included in any network </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-input-network-blacklist-file blacklist.dat </td><td valign="top">a list of edges that must <i>not</i> be included in any network </td><td valign="top"></td></tr>
<tr><td valign="top">-input-network-blacklist-edge-type dataName1 dataName2 </td><td valign="top">edge types that may <i>not</i> be included in any network. The collection of nodes are given by the data input name, and so the data types must be given in different files </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-input-network-no-parents-node nodeX </td><td valign="top">nodeX must not have any parents (except for white edges) </td><td valign="top"></td></tr>
<tr><td valign="top">-input-network-no-children-node nodeY </td><td valign="top">nodeY must not have any children (except for white edges) </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-input-network-prob-edge node1 node2 prob </td><td valign="top">set the prior probability of edge direction of node1 to node2 as prob </td><td valign="top"></td></tr>
<tr><td valign="top">-input-network-prob-edge-type nodeType1 nodeType2 prob </td><td valign="top">set the prior probabilities of edge direction of nodeType1 to nodeType2 as prob </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-input-network-imaginary-sample-size i </td><td valign="top">for deal networks this sets the imaginary sample size </td><td valign="top">10</td></tr>
<tr><td valign="top">-input-network-score score </td><td valign="top">for a bnlearn network choose between loglike, AIC, BIC or bayes (BDe) </td><td valign="top">BIC</td></tr>
</table>
<h2><a name="input-network-black">6.2 Black lists</a></h2>
<p>
A black list can be given using the <tt>-input-network-blacklist-file</tt> option to define a list of edges that must not be included in any network. The text file should be formatted as follows: </p>
<pre>
node1 node2
node2 node1
node1 node3
</pre>
<p>
such that the two nodes of each blacklisted edge are on one line. The nodes are ordered so the first line states that the edge node1 to node2 is not permitted. The next line states that the edge in the reverse direction is also not permitted. </p>
<p>
Any searches will ignore these blacklisted edges and attempting to use a network with a blacklisted edge will result in the edge being removed. </p>
<p>
Edges between different types of nodes may also be blacklisted. This can be done using the <tt>-input-network-blacklist-edge-type</tt> option. It can be used as follows: </p>
<pre>
-input-data
-input-data-name horses
-input-data-file horses.dat
-input-data-cts

-input-data
-input-data-name whips
-input-data-file whips.dat
-input-data-cts

-input-network
-input-network-name race
-input-network-file model.dat
-input-network-blacklist-edge-type horses whips 
</pre>
<p>
Firstly the different node types must be loaded separately and given names using the <tt>-input-data-name</tt> option. Then, when initially loading a network, the <tt>-input-network-blacklist-edge-type</tt> can be used to forbid any edge from one data set to another data set (or the same data if desired). In the above example the network may not have any edge that goes from a horse to a whip, that is, a whip node may not have a horse node as a parent. In any search that is performed these edges will not be considered. </p>
<h2><a name="input-network-white">6.3 White lists</a></h2>
<p>
A white list can be given using the <tt>-input-network-whitelist-file</tt> option to define a list of edges that must be included in any network. The text file should be formatted as follows: </p>
<pre>
node1 node3
node1 node2
node2 node1
</pre>
<p>
such that the two nodes of each whitelisted edge are on one line. The nodes are ordered so the first line states that the edge node1 to node3 must be included. If both directions are included between two nodes then the edge must be included but may be in any direction. </p>
<p>
If the whitelist and blacklist contradict one another then an error will be given. </p>
<h2><a name="input-network-soft-con">6.4 Soft Constraints</a></h2>
<p>
Soft constraints provide a way that the direction of an edge may be influenced but not with certainty, unlike blacklisted edges or whitelisted edges as described above. An example parameter file setting a soft constraint, such that the prior probability of variable <tt>express</tt> to variable <tt>pheno</tt> is believed to be 0.8 is shown below. </p>
<pre>
#input continuous data
-input-data
-input-data-file example-cts.dat
-input-data-cts

#input discrete data
-input-data
-input-data-file example-discrete.dat
-input-data-discrete

#input SNP data as discrete data
-input-data
-input-data-file example.bed
-input-data-discrete-snp

#input the example network in format 1
-input-network
-input-network-name myNetwork
-input-network-file example-network-format1.dat
-input-network-prob-edge express pheno 0.8

#search network models with the soft constraint
-search-models
</pre>
<p>
This parameter file, <tt>paras-soft-constraints.txt</tt>, can be found in <a href="example.zip">example.zip</a>.</p>
<p>
Any searches will use this prior probability. </p>
<p>
If you wish to blacklist or whitelist an edge you should use those options rather than setting the prior probability to 0 or 1 for the sake of computational efficiency. </p>
<h2><a name="input-network-formats">6.5 Network formats</a></h2>
<p>
The network may be defined using one of 3 different formats. </p>
<h3><a name="input-network-formats-format1">Network file format 1</a></h3>
<p>
The first format is given by using the <tt>-input-network-file</tt> option and the network text file should be formatted as follows: </p>
<pre>
node1
node2
node3
node2 node1
node3 node1
</pre>
<p>
where the nodes are listed first followed by the directed edges. In the above example there are 3 nodes and 2 edges, which are node2 to node1 and node3 to node1. </p>
<h3><a name="input-network-formats-format2">Network file format 2</a></h3>
<p>
The second format is given by using the <tt>-input-network-file2</tt> option and the network text file should be formatted as follows: </p>
<pre>
[node2][node3][node1|node2:node3]
</pre>
<p>
where the nodes are listed in order of dependency. The independent nodes node2 and node3 are list first followed by node1 which is a child node of both node2 and node3. This is the format that is typically output for searches and such like. </p>
<h3><a name="input-network-formats-format3">Network file format 3</a></h3>
<p>
The third format is given by using the <tt>-input-network-igraph-file-prefix</tt> option using the files that were output to draw the network in <tt>R</tt>, see <a href="plot-network.html#igraph">section 21.1</a>. There will be one file for the nodes and one for the edges, for example <tt>myNetwork-nodes.dat</tt> and <tt>myNetwork-edges.dat</tt> respectively. The node file will look something as follows: </p>
<pre>
id name type fileno
1 node1 c 1
2 node2 c 1
3 node3 c 1
</pre>
<p>
and the edges file will look like something as follows: </p>
<pre>
from to chisq
2 1 6860.83
3 1 5709.51
</pre>
<h2><a name="input-network-example">6.6 Example</a></h2>
<p>
The following is an example parameter file to input a network. </p>
<pre>
#input continuous data
-input-data
-input-data-file example-cts.dat
-input-data-cts

#input discrete data
-input-data
-input-data-file example-discrete.dat
-input-data-discrete

#input SNP data as discrete data
-input-data
-input-data-file example.bed
-input-data-discrete-snp

#input the example network in format 1
-input-network
-input-network-name myNetwork
-input-network-file example-network-format1.dat
</pre>
<p>
This parameter file, <tt>paras-input-network.txt</tt>, can be found in <a href="example.zip">example.zip</a>&nbsp;and can be used as follows: </p>
<pre>
./bayesnetty paras-input-network.txt
</pre>
<p>
Which should produce output that looks like something as follows: </p>
<pre>
BayesNetty: Bayesian Network software, v1.00
--------------------------------------------------
Copyright 2015-present Richard Howey, GNU General Public License, v3
Institute of Genetic Medicine, Newcastle University

Random seed: 1551697141
--------------------------------------------------
Task name: Task-1
Loading data
Continuous data file: example-cts.dat
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
Missing value: not set
--------------------------------------------------
--------------------------------------------------
Task name: Task-2
Loading data
Discrete data file: example-discrete.dat
Number of ID columns: 2
Including the 1 and only variable in analysis
Each variable has 1500 data entries
Missing value: NA
--------------------------------------------------
--------------------------------------------------
Task name: Task-3
Loading data
SNP binary data file: example.bed
SNP data treated as discrete data
Total number of SNPs: 2
Total number of subjects: 1500
Number of ID columns: 2
Including (all) 2 variables in analysis
Each variable has 1500 data entries
--------------------------------------------------
--------------------------------------------------
Task name: myNetwork
Loading network
Network file: example-network-format1.dat
Network type: bnlearn
Network score type: BIC
Total number of nodes: 5 (Discrete: 3 | Factor: 0 | Continuous: 2)
Total number of edges: 4
Network Structure: [mood][rs1][rs2][pheno|rs1:rs2][express|pheno:mood]
Total data at each node: 1495
Missing data at each node: 5
--------------------------------------------------

Run time: 1 second
</pre>
<p>
The data is loaded and then the network is loaded. The network has been named &ldquo;myNetwork&rdquo;, and basic information about the network is output. </p>
<p>
Similarly, the network may be input using format 2 and 3 as given in parameter files <tt>paras-input-network2.txt</tt> and <tt>paras-input-network3.txt</tt> respectively. </p>
<br />
<div class="prevnext"><span class="left"><a href="input-data.html">&lt;-prev</a>
</span><span class="right"><a href="bnlearn.html">next-&gt;</a>
</span></div><!-- End Right Column -->
</div>
</td>
</tr></table>
<!-- End Wrapper -->
</td></tr></table>
</div>
 <!-- Default Statcounter code for Bayesnetty https://www.staff.ncl.ac.uk/richard.howey/bayesnetty/ --> <script type="text/javascript"> var sc_project=12004770; var sc_invisible=1; var sc_security="1ca06837"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12004770/0/1ca06837/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></body>
</html>
