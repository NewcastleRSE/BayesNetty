<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>BayesNetty: Bayesian Network Software for Genetic Analyses</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="bayesnettystyles.css" />
<link rel="shortcut icon" href="favicon.ico" />
</head>
<body>
<!-- Begin Wrapper -->
<div id="wrapper">
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td>
<!-- Begin Header -->
<div id="header">
<table><tr>
<td>
<img width="150" src="bayesnetty-logo.png" alt="BayesNetty: Bayesian Network Software for Genetic Analyses"/>
</td>
<td>
<p style="margin-left: 1em;">BayesNetty: Bayesian Network Software for Genetic Analyses</p>
</td></tr>
</table>
</div>
<!-- End Header -->
<!-- Begin Menu Navigation -->
<ul id="menunav">
<li><a href="index.html">Home</a></li>
<li><a href="downloads.html">Download</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
<!-- End Menu Navigation -->

</td></tr>
<tr><td>
<table border="0" cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<!-- Begin Left Column -->
<div id="leftcolumn">
<!-- Begin Contents Navigation -->
<div id="navcontainer">
<ul>
<li><a href="introduction.html">1 Introduction</a>
</li>
<li><a href="installation.html">2 Installation</a>
</li>
<li><a href="using.html">3 Using BayesNetty</a>
<ul>
<li><a href="using.html#basic-options">3.1 Basic Options</a></li>
<li><a href="using.html#parameterfile">3.2 Parameter file</a></li>
<li><a href="using.html#simple-example">3.3 Simple Example</a></li>
<li><a href="using.html#command-line">3.4 Command-line Options</a></li>
</ul>
</li>
<li><a href="parallel.html">4 Parallel BayesNetty</a>
<ul>
<li><a href="parallel.html#compile-parallel-code">4.1 Compilation Scripts</a></li>
</ul>
</li>
<li><a href="input-data.html">5 Input data</a>
<ul>
<li><a href="input-data.html#input-data-options">5.1 Options</a></li>
<li><a href="input-data.html#input-data-discrete">5.2 Discrete data</a></li>
<li><a href="input-data.html#input-data-cts">5.3 Continuous data</a></li>
<li><a href="input-data.html#input-data-factor">5.4 Factor data</a></li>
<li><a href="input-data.html#input-data-snp">5.5 SNP data</a></li>
<li><a href="input-data.html#input-data-missing">5.6 Missing data</a></li>
<li><a href="input-data.html#input-data-ids">5.7 Data IDs</a></li>
<li><a href="input-data.html#input-data-example">5.8 Example</a></li>
</ul>
</li>
<li><a href="input-network.html">6 Input network</a>
<ul>
<li><a href="input-network.html#input-network-options">6.1 Options</a></li>
<li><a href="input-network.html#input-network-black">6.2 Black lists</a></li>
<li><a href="input-network.html#input-network-white">6.3 White lists</a></li>
<li><a href="input-network.html#input-network-soft-con">6.4 Soft Constraints</a></li>
<li><a href="input-network.html#input-network-formats">6.5 Network formats</a></li>
<li><a href="input-network.html#input-network-example">6.6 Example</a></li>
</ul>
</li>
<li><a href="bnlearn.html">7 bnlearn network</a>
<ul>
<li><a href="bnlearn.html#bnlearn-score">7.1 Network score</a></li>
</ul>
</li>
<li><a href="deal.html">8 deal network</a>
<ul>
<li><a href="deal.html#imaginary-sample-size">8.1 Imaginary sample size</a></li>
</ul>
</li>
<li><a href="calc-score.html">9 Calculate network score</a>
<ul>
<li><a href="calc-score.html#calc-score-options">9.1 Options</a></li>
<li><a href="calc-score.html#calc-score-example">9.2 Example</a></li>
</ul>
</li>
<li><a href="calc-posterior.html">10 Calculate posterior</a>
<ul>
<li><a href="calc-posterior.html#calc-posterior-options">10.1 Options</a></li>
<li><a href="calc-posterior.html#calc-post-example">10.2 Example</a></li>
</ul>
</li>
<li><a href="search-models.html">11 Search models</a>
<ul>
<li><a href="search-models.html#search-models-options">11.1 Options</a></li>
<li><a href="search-models.html#search-models-greedy">11.2 Greedy search</a></li>
<li><a href="search-models.html#search-models-example">11.3 Example</a></li>
</ul>
</li>
<li><a href="average-network.html">12 Average network</a>
<ul>
<li><a href="average-network.html#average-network-options">12.1 Options</a></li>
<li><a href="average-network.html#average-network-score">12.2 Score Method</a></li>
<li><a href="average-network.html#average-network-example">12.3 Example</a></li>
<li><a href="average-network.html#average-network-parallel">12.4 Parallel Example</a></li>
</ul>
</li>
<li><a href="impute-data.html">13 Impute Data</a>
<ul>
<li><a href="impute-data.html#impute-data-options">13.1 Options</a></li>
<li><a href="impute-data.html#impute-example">13.2 Example</a></li>
<li><a href="impute-data.html#impute-parallel-example">13.3 Parallel Example</a></li>
</ul>
</li>
<li><a href="estimate-impute.html">14 Estimate Imputation Benefit</a>
<ul>
<li><a href="estimate-impute.html#estimate-impute-options">14.1 Options</a></li>
<li><a href="estimate-impute.html#estimate-impute-example">14.2 Example</a></li>
</ul>
</li>
<li><a href="calc-recall-precision.html">15 Calculate Recall and Precision</a>
<ul>
<li><a href="calc-recall-precision.html#calc-recall-precision-options">15.1 Options</a></li>
<li><a href="calc-recall-precision.html#calc-recall-precision-example">15.2 Example</a></li>
</ul>
</li>
<li><a href="sim-data.html">16 Simulate network data</a>
<ul>
<li><a href="sim-data.html#sim-data-options">16.1 Options</a></li>
<li><a href="sim-data.html#sim-data-example1">16.2 Example 1: no data</a></li>
<li><a href="sim-data.html#sim-data-example2">16.3 Example 2: data and fitted network</a></li>
<li><a href="sim-data.html#sim-data-example3">16.4 Example 3: data and unknown network</a></li>
</ul>
</li>
<li><a href="markov-blanket.html">17 Markov blanket</a>
<ul>
<li><a href="markov-blanket.html#markov-blanket-options">17.1 Options</a></li>
<li><a href="markov-blanket.html#calc-blanket-example">17.2 Example</a></li>
</ul>
</li>
<li><a href="output-network.html">18 Output network</a>
<ul>
<li><a href="output-network.html#output-network-options">18.1 Options</a></li>
<li><a href="output-network.html#output-network-example">18.2 Example</a></li>
</ul>
</li>
<li><a href="output-priors.html">19 Output priors (deal only)</a>
<ul>
<li><a href="output-priors.html#output-priors-options">19.1 Options</a></li>
<li><a href="output-priors.html#output-priors-example">19.2 Example</a></li>
</ul>
</li>
<li><a href="output-posteriors.html">20 Output posteriors</a>
<ul>
<li><a href="output-posteriors.html#output-posteriors-options">20.1 Options</a></li>
<li><a href="output-posteriors.html#output-posts-example">20.2 Example</a></li>
</ul>
</li>
<li><a href="plot-network.html">21 Network plotting</a>
<ul>
<li><a href="plot-network.html#igraph">21.1 igraph</a></li>
<li><a href="plot-network.html#igraph-example">21.2 Example</a></li>
</ul>
</li>
<li><a href="references.html">References</a></li>
</ul>
</div>
<!-- End Contents Navigation -->
</div>
<!-- End Left Column -->
</td>
<td valign="top">
<!-- Begin Right Column -->
<div id="rightcolumn">
<h1>14 Estimate Imputation Benefit</h1>
<p>
For a given data set with missing data it is natural to wonder how much benefit imputation brings. We include an option in BayesNetty to attempt to compare different methods of fitting a best fit network to this data set. We use estimates of the recall and precision to compare the methods. The recall is the percentage of edges that were recovered from the simulation model and the precision is the percentage of edges in the fitted model that are in the simulation model. For an edge to be correct it must be in the correct direction. However, if the simulating network has equivalent networks such that some edges may be in either direction, then these edges are considered correct if they are in any direction. </p>
<p>
The method follows these steps: </p>
<ol>
<li>
An initial network is fitted using imputation. </li><li>
Data is simulated using this network for the same number of individuals in the original data set. </li><li>
A best fit network is found for the full data set. </li><li>
The simulated data set has values set to missing as in the original data set. </li><li>
Best fit networks are found for this data set using: (i) a reduced data set with only complete data; (ii) data imputation; (iii) data imputation with complete training data. </li><li>
Recall and precision are calculated for the 4 different best fit networks against the simulation network.</li>
</ol>
<p>
This method can be repeated a number times as is computationally feasible to take average recall and precision estimates to account for variability in the simulated data. The recall and precision using the full data set gives an estimate of an upper limit of what may feasibly be achieved using data imputation. Comparing the recall and precision of the reduced data set with imputation gives an estimate of the increased benefit of using imputation. Comparing the two imputation methods should show when it is appropriate to use the variant imputation method. </p>
<p>
A major drawback of this estimation method is the obvious fact that we do not know the &ldquo;true&rdquo; network structure of the data, we therefore use an estimated network to simulate the data and hope this is sufficiently close for the results to be useful. In general, we have found that the benefits of imputation are often understated as the simulation network tends to be set without some of the weaker edges that cannot always be detected (when using data sets where we do actually know the &ldquo;true&rdquo; network). Even if we cannot be too sure of the exact gain in benefit of imputation this BayesNetty estimation method can give clear confidence of a benefit when there are large differences (and if the variant method using complete training data performs any better). </p>
<h2><a name="estimate-impute-options">14.1 Options</a></h2>
<p>
The options are as follows: </p>
<table id="tablestylel" class="center">
<tr><th>Option </th><th>Description </th><th>Default</th></tr>
<tr class="alt"><td valign="top">-impute-estimate-recall-precision </td><td valign="top">do a task to estimate recall and precision before and after data imputation</td></tr>
<tr><td valign="top">-impute-estimate-recall-precision name </td><td valign="top">label the task with a name </td><td valign="top">Task-n</td></tr>
<tr class="alt"><td valign="top">-impute-estimate-recall-precision-network-name network </td><td valign="top">set the name of the initial network when estimating recall and precision </td><td valign="top">previous network (or the default model given by a node for each data variable and no edges if there is no previous network)</td></tr>
<tr><td valign="top">-impute-estimate-recall-precision-random-restarts n </td><td valign="top">for each network fit do another n searches starting from a random network </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-impute-estimate-recall-precision-jitter-restarts m </td><td valign="top">for each network fit after the initial search and every random restart search do another m searches jittered from the recently found network </td><td valign="top">0</td></tr>
<tr><td valign="top">-impute-estimate-recall-precision-skip-imputation </td><td valign="top">do not estimate recall and precision for imputed data </td><td valign="top"></td></tr>
<tr class="alt"><td valign="top">-impute-estimate-recall-precision-iterations i </td><td valign="top">estimate the recall and precision i times and take the average </td><td valign="top">1</td></tr>
</table>
<h2><a name="estimate-impute-example">14.2 Example</a></h2>
<p>
An example of estimating the recall and precision is contained in the parameter file <tt>paras-example-estimate-recall-precision.txt</tt>, which can be found in <a href="example.zip">example.zip</a>.For simplicity the example is chosen to be a discrete network and this approach can be used for any kind of data. The network is the <tt>child</tt> network from the bnlearn repository <a href="references.html#bnlearn">Scutari and Denis (2014)</a>. </p>
<pre>
#input example data to estimate recall and precision from
-input-data
-input-data-file data-example-est-recall-precision.dat
-input-data-ids 0
-input-data-discrete

#set up network with no edges
-input-network
-input-network-empty

#estimate recall and precision for this data set
-impute-estimate-recall-precision
-impute-estimate-recall-precision-iterations 10
-impute-estimate-recall-precision-random-restarts 2
-impute-estimate-recall-precision-jitter-restarts 2
</pre>
<p>
This can be executed as usual </p>
<pre>
./bayesnetty paras-example-estimate-recall-precision.txt
</pre>
<p>
and will output something as follows </p>
<pre>
BayesNetty: Bayesian Network software, v1.1
--------------------------------------------------
Copyright 2015-present Richard Howey, GNU General Public License, v3
Institute of Genetic Medicine, Newcastle University

Random seed: 1605624192
--------------------------------------------------
Task name: Task-1
Loading data
Discrete data file: data-example-est-recall-precision.dat
Number of ID columns: 0
Including (all) 20 variables in analysis
Each variable has 500 data entries
Missing value: NA
--------------------------------------------------
--------------------------------------------------
Task name: Task-2
Loading network
Network set with no edges
Network type: bnlearn
Network score type: BIC
Total number of nodes: 20 (Discrete: 20 | Factor: 0 | Continuous: 0)
Total number of edges: 0
Network Structure: [Age][BirthAsphyxia][CO2Report][CO2][CardiacMixing][ChestXray][Disease][DuctFlow]
[GruntingReport][Grunting][HypDistrib][HypoxiaInO2][LVH][LVHreport][LowerBodyO2][LungFlow][LungParench][RUQO2][Sick][XrayReport]
Total data at each node: 54
Missing data at each node: 446
--------------------------------------------------
--------------------------------------------------
Task name: Task-3
Estimating the recall and precision when imputing network data
Network: Task-2
Number of iterations: 10
Random restarts: 2
Random jitter restarts: 2
Minimum percentage of non-missing edges (or singleton nodes) required to impute individual: 0
Individuals with data: 54
Individuals with missing data: 446

Recall: the percentage of edges found from the original true network
Precision: the percentage of edges in the network that are also in the original true network

                                   Recall     Precision
No imputation                      40.91      61.66
Imputation                         78.95      89.03
Imputation (complete training)     67.75      80.04
Full data (upper limit)            90.21      95.02

--------------------------------------------------

Run time: 1 hour, 39 minutes and 23 seconds
</pre>
<p>
From the example output we can see that with no imputation the recall is estimated to be 40.91 percent and the precision estimated to be is 61.66 percent, but if the full data were available it would be 90.21 and 95.02 respectively. Using our imputation method the estimated recall and precision is 78.95 and 89.03 respectively, which is quite a large increase. Our variant imputation method with complete training data also increases the recall and precision by quite a lot. </p>
<p>
Note that the estimation is stochastic due to the stochastic nature of the imputation method, and to a lesser extent the stochastic nature of finding a best fit model, and so rerunning the analyses may results in slightly different estimates. </p>
<br />
<div class="prevnext"><span class="left"><a href="impute-data.html">&lt;-prev</a>
</span><span class="right"><a href="calc-recall-precision.html">next-&gt;</a>
</span></div><!-- End Right Column -->
</div>
</td>
</tr></table>
<!-- End Wrapper -->
</td></tr></table>
</div>
 <!-- Default Statcounter code for Bayesnetty https://www.staff.ncl.ac.uk/richard.howey/bayesnetty/ --> <script type="text/javascript"> var sc_project=12004770; var sc_invisible=1; var sc_security="1ca06837"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12004770/0/1ca06837/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code --></body>
</html>
